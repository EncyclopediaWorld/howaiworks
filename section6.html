<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Section VI ‚Äî The Deep Learning Explosion ¬∑ How AI Works</title>
<link rel="stylesheet" href="styles.css">
</head><body>
<div class="progress-bar" style="background:linear-gradient(90deg,var(--a5),var(--a6))"></div>
<button class="back-top" onclick="window.scrollTo({top:0,behavior:'smooth'})">‚Üë</button>
<nav class="topnav"><a href="index.html" class="logo">How AI Works</a><div class="nav-links"><a href="section1.html">I</a><a href="section2.html">II</a><a href="section3.html">III</a><a href="section4.html">IV</a><a href="section5.html">V</a><a href="section6.html" class="active">VI</a><a href="section7.html">VII</a><a href="section8.html">VIII</a></div></nav>
<div class="section-hero"><div class="era-label" style="color:var(--a5)">Section VI ¬∑ 2012‚Äì2015</div>
<h1>The Deep Learning Explosion</h1><p>AlexNet triggers the revolution. GANs, attention, ResNets, and Word2Vec reshape AI forever.</p>
<div class="nav-arrows"><a href="section5.html">&larr; Section V</a><a href="section7.html">Section VII &rarr;</a></div></div>
<div class="models-container">

<!-- ======= ALEXNET ======= -->
<div class="model-card" id="model-alexnet"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2012</span><div class="mc-info">
<h3>AlexNet <a href="https://papers.nips.cc/paper/2012/hash/c399862d3b9d6b76c8436e924a68c45b-Abstract.html" target="_blank" class="paper-link">Paper</a></h3>
<p>Krizhevsky's CNN crushed ImageNet by 10%. Deeper than LeNet with ReLU, dropout, and GPU training. Proved deep learning works at scale.</p>
<div class="model-lineage">Scales <a href="section4.html#model-cnn">CNN/LeNet</a> with <a href="section6.html#model-dropout">Dropout</a> and GPU power; its ImageNet victory ignites the deep learning era leading to <a href="section6.html#model-resnet">ResNet</a> and <a href="section8.html#model-vit">ViT</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">227√ó227 ‚Üí Conv(96) ‚Üí Pool ‚Üí Conv(256) ‚Üí Pool ‚Üí Conv(384) ‚Üí Conv(384) ‚Üí Conv(256) ‚Üí FC ‚Üí 1000 classes</div>
<div class="mc-demo" id="demo-alex"></div></div>

<!-- ======= DROPOUT ======= -->
<div class="model-card" id="model-dropout"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2014</span><div class="mc-info">
<h3>Dropout <a href="https://jmlr.org/papers/v15/srivastava14a.html" target="_blank" class="paper-link">Paper</a></h3>
<p>Randomly "kill" neurons during training. Forces the network to not rely on any single neuron ‚Äî like training an ensemble of sub-networks.</p>
<div class="model-lineage">Key regularization technique first used in <a href="section6.html#model-alexnet">AlexNet</a>; prevents overfitting in all deep networks from <a href="section6.html#model-resnet">ResNet</a> to <a href="section7.html#model-transformer">Transformer</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">During training: h·µ¢ = h·µ¢ √ó Bernoulli(p) ‚Äî each neuron dropped with probability (1-p)</div>
<div class="mc-demo" id="demo-drop"></div></div>

<!-- ======= WORD2VEC ======= -->
<div class="model-card" id="model-word2vec"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2013</span><div class="mc-info">
<h3>Word2Vec <a href="https://arxiv.org/abs/1301.3781" target="_blank" class="paper-link">Paper</a></h3>
<p>Mikolov's word embeddings ‚Äî learn vector representations where semantic relationships become arithmetic: King ‚àí Man + Woman ‚âà Queen.</p>
<div class="model-lineage">Simplifies <a href="section5.html#model-nnlm">NNLM</a> into efficient embedding training; its dense vectors become the input layer for <a href="section7.html#model-elmo">ELMo</a>, <a href="section7.html#model-bert">BERT</a>, and all modern NLP.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">king ‚àí man + woman ‚âà queen ‚Äî semantic arithmetic in vector space!</div>
<div class="mc-demo" id="demo-w2v"></div></div>

<!-- ======= VAE ======= -->
<div class="model-card" id="model-vae"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2013</span><div class="mc-info">
<h3>VAE (Variational Autoencoder) <a href="https://arxiv.org/abs/1312.6114" target="_blank" class="paper-link">Paper</a></h3>
<p>Kingma's generative model ‚Äî encode data into a smooth latent distribution, sample, and decode. The latent space is continuous and interpolatable.</p>
<div class="model-lineage">Adds probabilistic sampling to <a href="section5.html#model-sparse-ae">Sparse Autoencoder</a> using <a href="section4.html#model-gmm">GMM+EM</a>'s variational ideas; its latent space concept flows into <a href="section8.html#model-diffusion">Diffusion Models</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">Encode: x ‚Üí (Œº, œÉ¬≤) ‚Üí sample z ~ N(Œº,œÉ¬≤) ‚Üí Decode: z ‚Üí xÃÇ ‚Äî smooth generative latent space</div>
<div class="mc-demo" id="demo-vae"></div></div>

<!-- ======= GAN ======= -->
<div class="model-card" id="model-gan"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2014</span><div class="mc-info">
<h3>GAN (Generative Adversarial Network) <a href="https://arxiv.org/abs/1406.2661" target="_blank" class="paper-link">Paper</a></h3>
<p>Goodfellow's brilliant idea ‚Äî two networks competing: Generator creates fakes, Discriminator judges real vs fake. They push each other to improve.</p>
<div class="model-lineage">A new generative paradigm rivaling <a href="section6.html#model-vae">VAE</a>; leads to <a href="section7.html#model-stylegan">StyleGAN</a> for photorealistic faces, later surpassed by <a href="section8.html#model-diffusion">Diffusion Models</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">min_G max_D [E log D(x) + E log(1-D(G(z)))] ‚Äî Generator vs Discriminator game</div>
<div class="mc-demo" id="demo-gan"></div></div>

<!-- ======= SEQ2SEQ ======= -->
<div class="model-card" id="model-seq2seq"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2014</span><div class="mc-info">
<h3>Seq2Seq + Attention <a href="https://arxiv.org/abs/1409.0473" target="_blank" class="paper-link">Paper</a></h3>
<p>Bahdanau's attention mechanism ‚Äî let the decoder LOOK BACK at relevant input parts at each step. Revolutionary for translation.</p>
<div class="model-lineage">Extends <a href="section4.html#model-lstm">LSTM</a> encoder-decoder with attention; this attention idea is generalized into the pure-attention <a href="section7.html#model-transformer">Transformer</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">attention(Q,K) = softmax(Q¬∑K·µÄ) ¬∑ V ‚Äî focus on relevant input words for each output word</div>
<div class="mc-demo" id="demo-attn"></div></div>

<!-- ======= RESNET ======= -->
<div class="model-card" id="model-resnet"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2015</span><div class="mc-info">
<h3>ResNet (Residual Network) <a href="https://arxiv.org/abs/1512.03385" target="_blank" class="paper-link">Paper</a></h3>
<p>He's skip connections ‚Äî learn the residual F(x) = H(x) ‚àí x. Output = F(x) + x. Lets gradients flow through shortcuts, enabling 152+ layers.</p>
<div class="model-lineage">Solves the depth problem of <a href="section6.html#model-alexnet">AlexNet</a> with skip connections; its residual design is adopted by <a href="section7.html#model-transformer">Transformer</a> and <a href="section8.html#model-vit">ViT</a>.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">output = F(x) + x ‚Äî skip connection lets gradient flow through identity shortcut</div>
<div class="mc-demo" id="demo-resnet"></div></div>

<!-- ======= BATCHNORM ======= -->
<div class="model-card" id="model-batchnorm"><div class="mc-head"><span class="mc-year" style="color:var(--a5)">2015</span><div class="mc-info">
<h3>Batch Normalization <a href="https://arxiv.org/abs/1502.03167" target="_blank" class="paper-link">Paper</a></h3>
<p>Ioffe & Szegedy ‚Äî normalize each layer's inputs to zero mean and unit variance. Speeds up training and allows higher learning rates.</p>
<div class="model-lineage">Stabilizes deep network training for <a href="section6.html#model-resnet">ResNet</a> and beyond; adapted as LayerNorm in <a href="section7.html#model-transformer">Transformer</a> and all modern architectures.</div>
</div></div>
<div class="mc-formula" style="color:var(--a5)">xÃÇ = (x ‚àí Œº_batch) / ‚àö(œÉ¬≤_batch + Œµ) ¬∑ Œ≥ + Œ≤ ‚Äî normalize, then scale and shift (learnable)</div>
<div class="mc-demo" id="demo-bn"></div></div>

</div>
<footer><a href="section5.html">&larr; Section V</a> &middot; <a href="section7.html">Section VII: The Transformer Revolution &rarr;</a></footer>
<script src="shared.js"></script>
<script>
// ===== ALEXNET =====
(function(){const el=$('demo-alex'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Click layers to highlight. See image shrink through conv+pool while feature channels multiply.');
const ld=[{name:'Input',w:227,h:227,d:3,c:'#38bdf8',desc:'RGB image'},
{name:'Conv1+Pool',w:27,h:27,d:96,c:'#ff6b6b',desc:'96 filters, edges'},
{name:'Conv2+Pool',w:13,h:13,d:256,c:'#ffd166',desc:'256, textures'},
{name:'Conv3',w:13,h:13,d:384,c:'#4ecdc4',desc:'384, patterns'},
{name:'Conv4',w:13,h:13,d:384,c:'#a78bfa',desc:'384, parts'},
{name:'Conv5+Pool',w:6,h:6,d:256,c:'#fb923c',desc:'256, objects'},
{name:'FC-4096',w:1,h:1,d:4096,c:'#f472b6',desc:'4096 neurons'},
{name:'Output',w:1,h:1,d:1000,c:'#34d399',desc:'1000 classes'}];
let hov=-1;
function draw(){ctx.clearRect(0,0,750,300);
let ox=15,sp=92;
ld.forEach((L,i)=>{let x=ox+i*sp,y=55;
let vH=Math.min(L.w/227*140+20,160),vW=Math.max(L.d/4096*60+15,20);
let isH=i===hov;
ctx.fillStyle=isH?L.c+'44':L.c+'15';ctx.beginPath();ctx.roundRect(x,y+(160-vH)/2,vW,vH,4);ctx.fill();
ctx.strokeStyle=isH?L.c:L.c+'66';ctx.lineWidth=isH?2:1;ctx.beginPath();ctx.roundRect(x,y+(160-vH)/2,vW,vH,4);ctx.stroke();
if(L.d>3){let off=Math.min(L.d/4096*8+2,10);
ctx.fillStyle=L.c+'11';ctx.beginPath();ctx.roundRect(x+off,y+(160-vH)/2-off,vW,vH,4);ctx.fill();
ctx.strokeStyle=L.c+'33';ctx.beginPath();ctx.roundRect(x+off,y+(160-vH)/2-off,vW,vH,4);ctx.stroke()}
ctx.fillStyle=isH?L.c:'#7d7a8c';ctx.font=(isH?'600':'400')+' 8px Fira Code';ctx.textAlign='center';
ctx.fillText(L.name,x+vW/2,y+172);
if(isH){ctx.fillStyle=L.c;ctx.font='500 7px Fira Code';ctx.fillText(L.w+'√ó'+L.h+'√ó'+L.d,x+vW/2,y+185);ctx.fillText(L.desc,x+vW/2,y+197)}
ctx.textAlign='left';
if(i<ld.length-1){ctx.fillStyle='#4a475a33';ctx.font='12px sans-serif';ctx.fillText('‚Üí',x+vW+5,y+80)}});
ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(15,248,720,45,8);ctx.fill();
ctx.fillStyle='#ff6b6b';ctx.font='600 10px Fira Code';ctx.fillText('AlexNet (2012): Won ImageNet with 15.3% error (prev: 26%)',25,266);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';
ctx.fillText('Key innovations: ReLU (fast), Dropout (regularize), GPU training (speed), Data augmentation (more data)',25,284)}
c.onmousemove=e=>{let r=c.getBoundingClientRect(),mx=(e.clientX-r.left)*750/r.width;hov=Math.floor((mx-15)/92);if(hov<0||hov>=ld.length)hov=-1;draw()};
c.onmouseleave=()=>{hov=-1;draw()};
const ctrl=addControls(el);draw()})();

// ===== DROPOUT =====
(function(){const el=$('demo-drop'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Toggle Training vs Inference mode. "Resample" shows different dropout masks.');
let mode='train',dropRate=.5;
const layers=[[0,1,2,3],[0,1,2,3,4,5],[0,1,2,3,4,5],[0,1,2,3]];
let masks=layers.map(l=>l.map(()=>Math.random()>dropRate?1:0));
function resample(){masks=layers.map(l=>l.map(()=>Math.random()>dropRate?1:0));draw()}
function draw(){ctx.clearRect(0,0,750,300);
let lx=[120,280,440,600],ly=150,labels=['Input','Hidden 1','Hidden 2','Output'],colors=['#38bdf8','#a78bfa','#fb923c','#34d399'];
for(let l=0;l<3;l++){layers[l].forEach((fi,fIdx)=>{layers[l+1].forEach((ti,tIdx)=>{
let fA=mode==='test'||masks[l][fIdx],tA=mode==='test'||masks[l+1][tIdx];
let fy=ly-layers[l].length*20+fIdx*40,ty=ly-layers[l+1].length*20+tIdx*40;
ctx.strokeStyle=fA&&tA?'rgba(255,255,255,.08)':'rgba(255,255,255,.02)';ctx.lineWidth=1;
ctx.beginPath();ctx.moveTo(lx[l],fy);ctx.lineTo(lx[l+1],ty);ctx.stroke()})})}
layers.forEach((layer,li)=>{layer.forEach((n,ni)=>{
let y=ly-layer.length*20+ni*40,active=mode==='test'||masks[li][ni];
ctx.save();if(active){ctx.shadowColor=colors[li];ctx.shadowBlur=10}
ctx.beginPath();ctx.arc(lx[li],y,14,0,TAU);
ctx.fillStyle=active?colors[li]+'33':'#0c0c16';ctx.fill();
ctx.strokeStyle=active?colors[li]:'#333';ctx.lineWidth=active?2:1;ctx.stroke();ctx.restore();
if(!active){ctx.strokeStyle='#ff6b6b';ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(lx[li]-8,y-8);ctx.lineTo(lx[li]+8,y+8);ctx.stroke();
ctx.beginPath();ctx.moveTo(lx[li]+8,y-8);ctx.lineTo(lx[li]-8,y+8);ctx.stroke()}
ctx.fillStyle=active?'#e4e2df':'#4a475a';ctx.font='bold 8px Fira Code';ctx.textAlign='center';
ctx.fillText(active?(mode==='test'?'√ó'+dropRate.toFixed(1):'ON'):'OFF',lx[li],y+3);ctx.textAlign='left'})});
layers.forEach((l,i)=>{ctx.fillStyle=colors[i];ctx.font='500 9px Fira Code';ctx.textAlign='center';ctx.fillText(labels[i],lx[i],ly+l.length*20+20);ctx.textAlign='left'});
ctx.fillStyle='rgba(6,6,12,.9)';ctx.beginPath();ctx.roundRect(8,8,250,55,8);ctx.fill();
ctx.fillStyle=mode==='train'?'#ff6b6b':'#34d399';ctx.font='700 14px Fira Code';
ctx.fillText(mode==='train'?'üé≤ TRAINING':'‚úÖ INFERENCE',18,30);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';
ctx.fillText(mode==='train'?'Drop rate: '+(dropRate*100)+'% ‚Äî neurons randomly killed':'All active, weights scaled by p',18,50);
let active=masks.flat().filter(v=>v).length,total=masks.flat().length;
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(15,255,720,38,8);ctx.fill();
ctx.fillStyle='#ffd166';ctx.font='500 9px Fira Code';
ctx.fillText(mode==='train'?'Active: '+active+'/'+total+'. Each sample sees a DIFFERENT sub-network ‚Üí ensemble effect!':
'Test time: all neurons active, outputs √ó keep probability ('+dropRate+') to match training scale.',25,278)}
const ctrl=addControls(el);
const mt=document.createElement('button');mt.className='btn active';mt.textContent='üé≤ Train';
const mi=document.createElement('button');mi.className='btn';mi.textContent='‚úÖ Inference';
mt.onclick=()=>{mode='train';mt.classList.add('active');mi.classList.remove('active');resample()};
mi.onclick=()=>{mode='test';mi.classList.add('active');mt.classList.remove('active');draw()};
const rs=document.createElement('button');rs.className='btn';rs.textContent='üé≤ Resample';rs.onclick=resample;
ctrl.appendChild(mt);ctrl.appendChild(mi);ctrl.appendChild(rs);draw()})();

// ===== WORD2VEC =====
(function(){const el=$('demo-w2v'),[c,ctx]=createCanvas(el,750,320);
addHint(el,'Click analogies to see semantic arithmetic in vector space.');
const words={king:[.9,.8],queen:[.9,-.8],man:[.3,.7],woman:[.3,-.7],prince:[.7,.5],princess:[.7,-.5],
dog:[-.6,.3],cat:[-.5,-.3],puppy:[-.4,.4],kitten:[-.3,-.2],
paris:[-.8,.6],france:[-.7,.8],berlin:[-.8,-.4],germany:[-.7,-.6],tokyo:[-.9,0],japan:[-.8,.1]};
const analogies=[
{a:'king',b:'man',c:'woman',result:'queen',desc:'Royalty: gender relationship'},
{a:'paris',b:'france',c:'germany',result:'berlin',desc:'Capital: country relationship'},
{a:'puppy',b:'dog',c:'cat',result:'kitten',desc:'Young: species relationship'},
{a:'prince',b:'man',c:'woman',result:'princess',desc:'Royal gender relationship'}];
let selAn=0;
function draw(){ctx.clearRect(0,0,750,320);let an=analogies[selAn];
analogies.forEach((a,i)=>{let x=15+i*183,y=8;
ctx.fillStyle=i===selAn?'rgba(244,114,182,.12)':'#0c0c16';ctx.beginPath();ctx.roundRect(x,y,176,28,5);ctx.fill();
ctx.strokeStyle=i===selAn?'#f472b6':'#1e1e32';ctx.lineWidth=i===selAn?2:1;ctx.beginPath();ctx.roundRect(x,y,176,28,5);ctx.stroke();
ctx.fillStyle=i===selAn?'#e4e2df':'#4a475a';ctx.font='500 9px Fira Code';ctx.fillText(a.a+' ‚àí '+a.b+' + '+a.c+' = ?',x+8,y+18)});
let cx2=220,cy2=180,scale=120;
ctx.strokeStyle='#1a1a2a';ctx.lineWidth=1;
ctx.beginPath();ctx.moveTo(cx2-180,cy2);ctx.lineTo(cx2+180,cy2);ctx.stroke();
ctx.beginPath();ctx.moveTo(cx2,cy2-130);ctx.lineTo(cx2,cy2+130);ctx.stroke();
Object.entries(words).forEach(([w,v])=>{let x=cx2+v[0]*scale,y=cy2-v[1]*scale;
let isA=w===an.a,isB=w===an.b,isC=w===an.c,isR=w===an.result,hl=isA||isB||isC||isR;
ctx.beginPath();ctx.arc(x,y,hl?7:3,0,TAU);
ctx.fillStyle=isA?'#ff6b6b':isB?'#38bdf8':isC?'#ffd166':isR?'#34d399':'#4a475a';ctx.fill();
if(hl){ctx.fillStyle=isA?'#ff6b6b':isB?'#38bdf8':isC?'#ffd166':'#34d399';
ctx.font='600 10px Fira Code';ctx.textAlign='center';ctx.fillText(w,x,y-12);ctx.textAlign='left'}
else{ctx.fillStyle='#4a475a';ctx.font='400 7px Fira Code';ctx.textAlign='center';ctx.fillText(w,x,y-6);ctx.textAlign='left'}});
let va=words[an.a],vb=words[an.b],vc=words[an.c],vr=words[an.result];
if(va&&vb&&vc&&vr){ctx.strokeStyle='#ff6b6b88';ctx.lineWidth=2;ctx.setLineDash([5,3]);
ctx.beginPath();ctx.moveTo(cx2+va[0]*scale,cy2-va[1]*scale);ctx.lineTo(cx2+vb[0]*scale,cy2-vb[1]*scale);ctx.stroke();
ctx.strokeStyle='#34d39988';ctx.beginPath();ctx.moveTo(cx2+vc[0]*scale,cy2-vc[1]*scale);ctx.lineTo(cx2+vr[0]*scale,cy2-vr[1]*scale);ctx.stroke();ctx.setLineDash([])}
let rx=440,ry=45;
ctx.fillStyle='rgba(6,6,12,.9)';ctx.beginPath();ctx.roundRect(rx,ry,300,205,10);ctx.fill();
ctx.fillStyle='#f472b6';ctx.font='700 12px Fira Code';ctx.fillText('Word Vector Arithmetic',rx+10,ry+22);
ctx.fillStyle='#ff6b6b';ctx.font='600 11px Fira Code';ctx.fillText(an.a,rx+10,ry+48);
ctx.fillStyle='#7d7a8c';ctx.fillText(' ‚àí ',rx+60,ry+48);ctx.fillStyle='#38bdf8';ctx.fillText(an.b,rx+80,ry+48);
ctx.fillStyle='#7d7a8c';ctx.fillText(' + ',rx+130,ry+48);ctx.fillStyle='#ffd166';ctx.fillText(an.c,rx+155,ry+48);
ctx.fillStyle='#7d7a8c';ctx.fillText(' = ',rx+210,ry+48);ctx.fillStyle='#34d399';ctx.font='700 11px Fira Code';ctx.fillText(an.result+' ‚úì',rx+230,ry+48);
ctx.fillStyle='#e4e2df';ctx.font='400 9px Fira Code';ctx.fillText(an.desc,rx+10,ry+72);
ctx.fillStyle='#ffd166';ctx.font='600 9px Fira Code';ctx.fillText('How Word2Vec learns:',rx+10,ry+100);
ctx.fillStyle='#7d7a8c';ctx.font='400 8px Fira Code';
ctx.fillText('Skip-gram: predict context from word',rx+10,ry+118);
ctx.fillText('"The [cat] sat on" ‚Üí predict neighbors',rx+10,ry+134);
ctx.fillText('Similar contexts ‚Üí similar vectors',rx+10,ry+150);
ctx.fillText('Relationships become vector directions',rx+10,ry+166);
ctx.fillText('automatically ‚Äî no supervision needed!',rx+10,ry+182);
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(15,282,720,30,8);ctx.fill();
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';
ctx.fillText('Each word = dense vector (50-300 dims). Similar meaning = close in space. Relationships = consistent directions.',25,301)}
c.onclick=e=>{let r=c.getBoundingClientRect(),mx=(e.clientX-r.left)*750/r.width,my=(e.clientY-r.top)*320/r.height;
analogies.forEach((a,i)=>{let x=15+i*183;if(mx>=x&&mx<=x+176&&my>=8&&my<=36){selAn=i;draw()}})};
const ctrl=addControls(el);draw()})();

// ===== VAE =====
(function(){const el=$('demo-vae'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Hover the 2D latent space to generate! Smooth transitions = why VAEs work.');
let mx2=-1,my2=-1;
const cats=[{name:'Faces',z1:-.8,z2:.8,c:'#ff6b6b'},{name:'Cats',z1:.8,z2:.8,c:'#38bdf8'},
{name:'Cars',z1:-.8,z2:-.8,c:'#ffd166'},{name:'Flowers',z1:.8,z2:-.8,c:'#a78bfa'},{name:'Blend',z1:0,z2:0,c:'#4ecdc4'}];
function decode(z1,z2){let f=[];for(let i=0;i<6;i++)for(let j=0;j<6;j++){f.push(sigmoid(z1*Math.sin(i+j)+z2*Math.cos(i-j)+Math.sin(z1*z2*(i+1))))}return f}
function draw(){ctx.clearRect(0,0,750,300);
let lx=15,ly=18,lw=280,lh=230;
ctx.fillStyle='rgba(6,6,12,.9)';ctx.beginPath();ctx.roundRect(lx,ly,lw,lh,10);ctx.fill();
ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.fillText('2D Latent Space (z‚ÇÅ, z‚ÇÇ)',lx+8,ly+18);
for(let i=-2;i<=2;i++){let x=lx+lw/2+i*55,y=ly+lh/2+i*45;
ctx.strokeStyle='#1e1e32';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(x,ly+25);ctx.lineTo(x,ly+lh-5);ctx.stroke();
ctx.beginPath();ctx.moveTo(lx+5,y);ctx.lineTo(lx+lw-5,y);ctx.stroke()}
cats.forEach(cat=>{let x=lx+lw/2+cat.z1*55,y=ly+lh/2-cat.z2*45;
ctx.beginPath();ctx.arc(x,y,30,0,TAU);ctx.fillStyle=cat.c+'15';ctx.fill();
ctx.fillStyle=cat.c;ctx.font='500 8px Fira Code';ctx.textAlign='center';ctx.fillText(cat.name,x,y+3);ctx.textAlign='left'});
let z1=0,z2=0;
if(mx2>0){z1=(mx2-lx-lw/2)/55;z2=-(my2-ly-lh/2)/45;z1=clamp(z1,-2,2);z2=clamp(z2,-2,2);
ctx.save();ctx.shadowColor='#fff';ctx.shadowBlur=10;ctx.beginPath();ctx.arc(mx2,my2,5,0,TAU);ctx.fillStyle='#fff';ctx.fill();ctx.restore();
ctx.fillStyle='#e4e2df';ctx.font='400 7px Fira Code';ctx.fillText('z=('+z1.toFixed(1)+','+z2.toFixed(1)+')',mx2+8,my2-5)}
// Architecture
let ax=310,ay=28;
ctx.fillStyle='#38bdf8';ctx.font='600 9px Fira Code';ctx.fillText('Encoder',ax,ay);
ctx.fillStyle='rgba(56,189,248,.08)';ctx.beginPath();ctx.roundRect(ax,ay+5,70,55,6);ctx.fill();
ctx.strokeStyle='#38bdf866';ctx.beginPath();ctx.roundRect(ax,ay+5,70,55,6);ctx.stroke();
ctx.fillStyle='#7d7a8c';ctx.font='400 8px Fira Code';ctx.fillText('x ‚Üí Œº,œÉ',ax+5,ay+32);ctx.fillText('‚Üí',ax+75,ay+32);
ctx.fillStyle='#a78bfa';ctx.font='600 9px Fira Code';ctx.fillText('Sample z',ax+88,ay);
ctx.fillStyle='rgba(167,139,250,.08)';ctx.beginPath();ctx.roundRect(ax+88,ay+5,60,55,6);ctx.fill();
ctx.strokeStyle='#a78bfa66';ctx.beginPath();ctx.roundRect(ax+88,ay+5,60,55,6);ctx.stroke();
ctx.fillStyle='#7d7a8c';ctx.font='400 8px Fira Code';ctx.fillText('z~N(Œº,œÉ)',ax+92,ay+32);ctx.fillText('‚Üí',ax+152,ay+32);
ctx.fillStyle='#4ecdc4';ctx.font='600 9px Fira Code';ctx.fillText('Decoder',ax+168,ay);
ctx.fillStyle='rgba(78,205,196,.08)';ctx.beginPath();ctx.roundRect(ax+168,ay+5,70,55,6);ctx.fill();
ctx.strokeStyle='#4ecdc466';ctx.beginPath();ctx.roundRect(ax+168,ay+5,70,55,6);ctx.stroke();
ctx.fillStyle='#7d7a8c';ctx.font='400 8px Fira Code';ctx.fillText('z ‚Üí xÃÇ',ax+173,ay+32);
// Generated
let rx=540,ry=18;ctx.fillStyle='#4ecdc4';ctx.font='600 10px Fira Code';ctx.fillText('Generated:',rx,ry+12);
let features=decode(z1,z2);
for(let i=0;i<6;i++)for(let j=0;j<6;j++){ctx.fillStyle=`rgba(78,205,196,${features[i*6+j]})`;ctx.fillRect(rx+j*28,ry+20+i*28,26,26)}
// Explanation
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(310,95,430,150,10);ctx.fill();
ctx.fillStyle='#ffd166';ctx.font='600 10px Fira Code';ctx.fillText('Why VAE is special:',320,115);
ctx.fillStyle='#e4e2df';ctx.font='400 9px Fira Code';
ctx.fillText('1. Encodes to DISTRIBUTION (Œº,œÉ), not a point',320,135);
ctx.fillText('2. Latent space is SMOOTH ‚Äî nearby ‚Üí similar',320,153);
ctx.fillText('3. Can INTERPOLATE between concepts',320,171);
ctx.fillText('4. Can GENERATE new data by sampling',320,189);
ctx.fillStyle='#a78bfa';ctx.font='500 9px Fira Code';ctx.fillText('Loss = Reconstruction + KL divergence',320,213);
ctx.fillStyle='#7d7a8c';ctx.fillText('z‚ÇÅ='+z1.toFixed(2)+', z‚ÇÇ='+z2.toFixed(2),320,233)}
c.onmousemove=e=>{let r=c.getBoundingClientRect();mx2=(e.clientX-r.left)*750/r.width;my2=(e.clientY-r.top)*300/r.height;
if(mx2>=15&&mx2<=295&&my2>=18&&my2<=248)draw();else{mx2=-1;my2=-1}};
c.onmouseleave=()=>{mx2=-1;my2=-1;draw()};
const ctrl=addControls(el);draw()})();

// ===== GAN =====
(function(){const el=$('demo-gan'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Watch Generator learn to fool Discriminator. G creates fakes, D judges. They co-evolve!');
let round=0,gSkill=0,dSkill=0,gSamples=[],realData=[];
for(let i=0;i<20;i++)realData.push({x:rand(400,700),y:rand(40,260)});
function step(){round++;gSkill=Math.min(gSkill+rand(.02,.06),1);dSkill=Math.min(dSkill+rand(.01,.04),.95);
gSamples=[];for(let i=0;i<15;i++){gSamples.push({x:rand(50,350)+gSkill*200,y:rand(40,260),score:dSkill*(1-gSkill)+rand(-.1,.1)})};draw()}
function draw(){ctx.clearRect(0,0,750,300);
realData.forEach(p=>{ctx.save();ctx.shadowColor='#34d399';ctx.shadowBlur=4;ctx.beginPath();ctx.arc(p.x,p.y,5,0,TAU);ctx.fillStyle='#34d399';ctx.fill();ctx.restore()});
gSamples.forEach(p=>{let fooled=p.score<.5;ctx.beginPath();ctx.arc(p.x,p.y,5,0,TAU);ctx.fillStyle=fooled?'#ffd166':'#ff6b6b55';ctx.fill();
if(fooled){ctx.strokeStyle='#ffd166';ctx.lineWidth=1;ctx.stroke()}});
ctx.fillStyle='rgba(6,6,12,.9)';ctx.beginPath();ctx.roundRect(8,8,220,70,8);ctx.fill();
ctx.fillStyle='#34d399';ctx.font='600 10px Fira Code';ctx.fillText('‚óè Real data (target)',18,26);
ctx.fillStyle='#ffd166';ctx.fillText('‚óè Generated (fooled D!)',18,44);
ctx.fillStyle='#ff6b6b';ctx.fillText('‚óã Generated (caught)',18,62);
ctx.fillStyle='rgba(6,6,12,.9)';ctx.beginPath();ctx.roundRect(8,90,220,90,8);ctx.fill();
ctx.fillStyle='#ffd166';ctx.font='600 10px Fira Code';ctx.fillText('Round '+round,18,108);
ctx.fillStyle='#f472b6';ctx.fillText('Generator: '+(gSkill*100|0)+'%',18,128);
ctx.fillStyle='#111120';ctx.fillRect(18,132,180,10);ctx.fillStyle='#f472b6';ctx.fillRect(18,132,180*gSkill,10);
ctx.fillStyle='#38bdf8';ctx.fillText('Discriminator: '+(dSkill*100|0)+'%',18,158);
ctx.fillStyle='#111120';ctx.fillRect(18,162,180,10);ctx.fillStyle='#38bdf8';ctx.fillRect(18,162,180*dSkill,10);
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(15,250,720,42,8);ctx.fill();
ctx.fillStyle='#ffd166';ctx.font='600 9px Fira Code';ctx.fillText('G tries to produce realistic samples. D tries to tell real from fake.',25,268);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';ctx.fillText('As training progresses, generated samples move closer to real distribution. When D can\'t tell ‚Üí G wins!',25,285)}
const ctrl=addControls(el);
const sb=document.createElement('button');sb.className='btn';sb.textContent='‚ñ∂ Train';sb.onclick=step;
let tmr=null;const ab=document.createElement('button');ab.className='btn';ab.textContent='‚è© Auto';
ab.onclick=()=>{if(tmr){clearInterval(tmr);tmr=null;ab.classList.remove('active')}else{tmr=setInterval(step,200);ab.classList.add('active')}};
const rst=document.createElement('button');rst.className='btn';rst.textContent='‚Üª Reset';
rst.onclick=()=>{round=0;gSkill=0;dSkill=0;gSamples=[];if(tmr){clearInterval(tmr);tmr=null;ab.classList.remove('active')}draw()};
ctrl.appendChild(sb);ctrl.appendChild(ab);ctrl.appendChild(rst);draw()})();

// ===== SEQ2SEQ + ATTENTION =====
(function(){const el=$('demo-attn'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Click output words to see which input words they attend to. Brighter = higher attention weight.');
const src=['The','cat','sat','on','the','mat'];
const tgt=['Le','chat','√©tait','assis','sur','le','tapis'];
const attnM=[[.8,.05,.02,.02,.08,.03],[.05,.75,.05,.03,.02,.1],[.02,.1,.6,.15,.03,.1],
[.03,.05,.15,.65,.05,.07],[.05,.02,.03,.1,.7,.1],[.7,.03,.02,.02,.15,.08],[.02,.08,.05,.05,.1,.7]];
let selT=1;
function draw(){ctx.clearRect(0,0,750,300);
let srcX=50,srcY=28,tgtY=198,gap=108;
ctx.fillStyle='#38bdf8';ctx.font='600 10px Fira Code';ctx.fillText('Source (English):',15,srcY-5);
src.forEach((w,i)=>{let x=srcX+i*gap;let attn=attnM[selT][i];
ctx.fillStyle=`rgba(56,189,248,${.05+attn*.4})`;ctx.beginPath();ctx.roundRect(x,srcY,98,32,6);ctx.fill();
ctx.strokeStyle=`rgba(56,189,248,${.2+attn*.8})`;ctx.lineWidth=1+attn*3;ctx.beginPath();ctx.roundRect(x,srcY,98,32,6);ctx.stroke();
ctx.fillStyle='#e4e2df';ctx.font='500 11px Fira Code';ctx.textAlign='center';ctx.fillText(w,x+49,srcY+20);
ctx.fillStyle='#ffd166';ctx.font='500 8px Fira Code';ctx.fillText((attn*100|0)+'%',x+49,srcY+44);ctx.textAlign='left'});
ctx.fillStyle='#4ecdc4';ctx.font='600 10px Fira Code';ctx.fillText('Target (French):',15,tgtY-5);
tgt.forEach((w,i)=>{let x=15+i*102;let isSel=i===selT;
ctx.fillStyle=isSel?'rgba(78,205,196,.15)':'rgba(78,205,196,.04)';ctx.beginPath();ctx.roundRect(x,tgtY,95,32,6);ctx.fill();
ctx.strokeStyle=isSel?'#4ecdc4':'#4ecdc444';ctx.lineWidth=isSel?2:1;ctx.beginPath();ctx.roundRect(x,tgtY,95,32,6);ctx.stroke();
ctx.fillStyle=isSel?'#e4e2df':'#7d7a8c';ctx.font=(isSel?'600':'400')+' 11px Fira Code';ctx.textAlign='center';ctx.fillText(w,x+47,tgtY+20);ctx.textAlign='left'});
src.forEach((w,i)=>{let attn=attnM[selT][i];if(attn<.02)return;
let sx=srcX+i*gap+49,sy=srcY+32,tx=15+selT*102+47,ty=tgtY;
ctx.strokeStyle=`rgba(255,209,102,${attn})`;ctx.lineWidth=attn*6;ctx.beginPath();ctx.moveTo(sx,sy+12);ctx.lineTo(tx,ty);ctx.stroke()});
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(15,248,720,45,8);ctx.fill();
ctx.fillStyle='#ffd166';ctx.font='600 9px Fira Code';ctx.fillText('Attention: each output word "looks back" at relevant input words.',25,266);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';ctx.fillText('Without attention: entire input compressed to ONE vector (information bottleneck). With attention: selective focus!',25,284)}
c.onclick=e=>{let r=c.getBoundingClientRect(),my=(e.clientY-r.top)*300/r.height,mx=(e.clientX-r.left)*750/r.width;
if(my>=tgtY&&my<=tgtY+32){tgt.forEach((w,i)=>{let x=15+i*102;if(mx>=x&&mx<=x+95){selT=i;draw()}})}};
const ctrl=addControls(el);draw()})();

// ===== RESNET =====
(function(){const el=$('demo-resnet'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Toggle skip connections on/off. See how gradients vanish without them!');
let skipOn=true,depth=8;
function draw(){ctx.clearRect(0,0,750,300);
let bx=50,by=45,bw=75,bh=45,gap=5;
for(let i=0;i<depth;i++){let x=bx+i*(bw+gap),y=by;
let grad=skipOn?1-i*0.05:Math.max(1-i*0.25,0.02);
ctx.fillStyle=`rgba(167,139,250,${grad*.15})`;ctx.beginPath();ctx.roundRect(x,y,bw,bh,6);ctx.fill();
ctx.strokeStyle=`rgba(167,139,250,${grad*.8+.2})`;ctx.lineWidth=1.5;ctx.beginPath();ctx.roundRect(x,y,bw,bh,6);ctx.stroke();
ctx.fillStyle=`rgba(228,226,223,${grad})`;ctx.font='600 9px Fira Code';ctx.textAlign='center';ctx.fillText('Block '+(i+1),x+bw/2,y+18);
ctx.fillStyle=`rgba(125,122,140,${grad})`;ctx.font='400 7px Fira Code';ctx.fillText('F(x)',x+bw/2,y+32);
ctx.fillStyle='#111120';ctx.fillRect(x+5,y+bh+5,bw-10,8);
ctx.fillStyle=grad>.3?'#34d399':'#ff6b6b';ctx.fillRect(x+5,y+bh+5,(bw-10)*grad,8);
ctx.fillStyle='#7d7a8c';ctx.font='400 6px Fira Code';ctx.fillText('grad: '+(grad*100|0)+'%',x+bw/2,y+bh+20);ctx.textAlign='left';
if(skipOn&&i%2===0&&i+2<=depth){let sx=x+bw/2,ex=x+(bw+gap)*2+bw/2;
ctx.strokeStyle='#ffd166';ctx.lineWidth=2;ctx.setLineDash([5,3]);ctx.beginPath();
ctx.moveTo(sx,y);ctx.quadraticCurveTo((sx+ex)/2,y-28,Math.min(ex,bx+(depth-1)*(bw+gap)+bw/2),y);ctx.stroke();ctx.setLineDash([]);
ctx.fillStyle='#ffd166';ctx.font='bold 12px Fira Code';ctx.textAlign='center';ctx.fillText('+',Math.min(ex,bx+(depth-1)*(bw+gap)+bw/2),y-5);ctx.textAlign='left'}
if(i<depth-1){ctx.fillStyle='#4a475a';ctx.font='10px sans-serif';ctx.fillText('‚Üí',x+bw+1,y+bh/2+4)}}
let fy=132;ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(15,fy,720,55,10);ctx.fill();
ctx.fillStyle=skipOn?'#ffd166':'#ff6b6b';ctx.font='700 12px Fira Code';
ctx.fillText(skipOn?'output = F(x) + x  ‚Üê skip connection':'output = F(x)  ‚Üê no skip (plain)',25,fy+20);
ctx.fillStyle='#e4e2df';ctx.font='400 9px Fira Code';
ctx.fillText(skipOn?'Gradient flows through BOTH F(x) AND identity shortcut. Even if F(x) vanishes, +x path survives!':
'Gradient must pass ALL layers. After many layers ‚Üí vanishing gradient problem.',25,fy+38);
ctx.fillStyle='#7d7a8c';ctx.fillText(skipOn?'ResNet-152 won ImageNet 2015. Skip connections allow 100+ layers!':'Without skips, >20 layers untrainable.',25,fy+52);
// Gradient comparison
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(15,200,720,92,10);ctx.fill();
ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.fillText('Gradient comparison:',25,220);
['Layer 1','Layer 4','Layer 8'].forEach((l,i)=>{let y2=230+i*18;
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';ctx.fillText(l,25,y2+10);
ctx.fillStyle='#111120';ctx.fillRect(100,y2,200,14);ctx.fillRect(410,y2,200,14);
let gs=[1,.8,.6],gn=[1,.25,.02];
ctx.fillStyle='#34d399';ctx.beginPath();ctx.roundRect(100,y2,200*gs[i],14,2);ctx.fill();
ctx.fillStyle='#ff6b6b';ctx.beginPath();ctx.roundRect(410,y2,200*gn[i],14,2);ctx.fill()});
ctx.fillStyle='#34d399';ctx.font='600 8px Fira Code';ctx.fillText('With Skip (ResNet)',100,228);
ctx.fillStyle='#ff6b6b';ctx.fillText('Without Skip',410,228)}
const ctrl=addControls(el);
const tog=document.createElement('button');tog.className='btn active';tog.textContent='‚úÖ Skip ON';
tog.onclick=()=>{skipOn=!skipOn;tog.textContent=skipOn?'‚úÖ Skip ON':'‚ùå Skip OFF';tog.classList.toggle('active');draw()};
ctrl.appendChild(tog);draw()})();

// ===== BATCH NORMALIZATION =====
(function(){const el=$('demo-bn'),[c,ctx]=createCanvas(el,750,300);
addHint(el,'Toggle BatchNorm on/off. Watch layer activations change from messy to well-behaved.');
let bnOn=true;
function getActs(layer,bn){let acts=[];
for(let i=0;i<80;i++){let v=Math.sin(i*.3+layer*2)+rand(-1,1)*(.5+layer*.3);if(!bn)v*=(1+layer*.4);acts.push(v)}
if(bn){let mean=acts.reduce((a,b)=>a+b)/acts.length;let std=Math.sqrt(acts.reduce((a,b)=>a+(b-mean)**2,0)/acts.length)||1;
acts=acts.map(v=>(v-mean)/std*.8+.1)}return acts}
function draw(){ctx.clearRect(0,0,750,300);
let nLayers=5,lw=130,lh=120,ox=25;
for(let l=0;l<nLayers;l++){let x=ox+l*(lw+15),y=28;
let acts=getActs(l,bnOn);
let bins=Array(20).fill(0);let mn=Math.min(...acts),mx2=Math.max(...acts);let range=mx2-mn||1;
acts.forEach(v=>{let bi=Math.floor((v-mn)/range*19);bins[Math.min(bi,19)]++});
let maxBin=Math.max(...bins)||1;
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(x,y,lw,lh,6);ctx.fill();
ctx.strokeStyle=bnOn?'#34d39944':'#ff6b6b44';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(x,y,lw,lh,6);ctx.stroke();
bins.forEach((b,bi)=>{let bx2=x+5+bi*(lw-10)/20,bh2=b/maxBin*(lh-30);
ctx.fillStyle=bnOn?'#34d39966':'#ff6b6b44';ctx.fillRect(bx2,y+lh-5-bh2,(lw-10)/20-1,bh2)});
let mean=acts.reduce((a,b)=>a+b)/acts.length;let meanX=x+5+(mean-mn)/range*(lw-10);
ctx.strokeStyle='#ffd166';ctx.lineWidth=1;ctx.setLineDash([3,3]);ctx.beginPath();ctx.moveTo(meanX,y+15);ctx.lineTo(meanX,y+lh-5);ctx.stroke();ctx.setLineDash([]);
ctx.fillStyle=bnOn?'#34d399':'#ff6b6b';ctx.font='600 9px Fira Code';ctx.textAlign='center';ctx.fillText('Layer '+(l+1),x+lw/2,y+15);
let std=Math.sqrt(acts.reduce((a,v)=>a+(v-mean)**2,0)/acts.length);
ctx.fillStyle='#7d7a8c';ctx.font='400 7px Fira Code';ctx.fillText('Œº='+mean.toFixed(2)+' œÉ='+std.toFixed(2),x+lw/2,y+lh+14);ctx.textAlign='left'}
let iy=175;ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(15,iy,720,118,10);ctx.fill();
ctx.fillStyle=bnOn?'#34d399':'#ff6b6b';ctx.font='700 13px Fira Code';
ctx.fillText(bnOn?'‚úÖ BatchNorm ON':'‚ùå BatchNorm OFF',25,iy+20);
ctx.fillStyle='#e4e2df';ctx.font='400 9px Fira Code';
if(bnOn){ctx.fillText('Activations normalized to mean‚âà0, std‚âà1. Stable distributions across all layers!',25,iy+40);
ctx.fillText('Benefits: faster convergence, higher lr, less sensitivity to initialization.',25,iy+58);
ctx.fillStyle='#ffd166';ctx.font='500 9px Fira Code';ctx.fillText('xÃÇ = (x‚àíŒº)/‚àö(œÉ¬≤+Œµ) then y = Œ≥xÃÇ+Œ≤ (Œ≥,Œ≤ learnable)',25,iy+78)}
else{ctx.fillText('Without BN: deeper layers have increasingly wild distributions (internal covariate shift).',25,iy+40);
ctx.fillText('Training slow, unstable. Requires careful init and low learning rate.',25,iy+58);
ctx.fillStyle='#ff6b6b';ctx.font='500 9px Fira Code';ctx.fillText('Notice: Layer 5 much wider than Layer 1 ‚Üí unreliable gradients!',25,iy+78)}
ctx.fillStyle='#7d7a8c';ctx.font='400 8px Fira Code';ctx.fillText('Used in: nearly every modern deep network (ResNet, Transformer variants, etc.)',25,iy+100);
ctx.fillText('Adapted as LayerNorm in Transformer (normalizes across features instead of batch).',25,iy+113)}
const ctrl=addControls(el);
const tog=document.createElement('button');tog.className='btn active';tog.textContent='‚úÖ BN ON';
tog.onclick=()=>{bnOn=!bnOn;tog.textContent=bnOn?'‚úÖ BN ON':'‚ùå BN OFF';tog.classList.toggle('active');draw()};
const rs2=document.createElement('button');rs2.className='btn';rs2.textContent='üé≤ Resample';rs2.onclick=draw;
ctrl.appendChild(tog);ctrl.appendChild(rs2);draw()})();
</script></body></html>

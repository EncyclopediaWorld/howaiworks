<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Section VIII — Foundation Models & The Multimodal Era · How AI Works</title>
<link rel="stylesheet" href="styles.css">
</head><body>
<div class="progress-bar" style="background:linear-gradient(90deg,var(--a8),var(--a2))"></div>
<button class="back-top" onclick="window.scrollTo({top:0,behavior:'smooth'})">↑</button>
<nav class="topnav"><a href="index.html" class="logo">How AI Works</a><div class="nav-links"><a href="section5.html">V</a><a href="section6.html">VI</a><a href="section7.html">VII</a><a href="section8.html" class="active">VIII</a></div></nav>
<div class="section-hero" style="background:radial-gradient(ellipse 60% 50% at 50% 70%,rgba(52,211,153,.07),transparent)">
  <div class="era-label" style="color:var(--a8)">Section VIII · 2020–Now</div>
  <h1>Foundation Models & The Multimodal Era</h1>
  <p>Emergent abilities, RLHF, diffusion, and multimodal understanding — AI enters everyday life at unprecedented scale.</p>
  <div class="nav-arrows"><a href="section7.html">&larr; Section VII</a><a href="index.html">Home &rarr;</a></div>
</div>
<div class="models-container">

<!-- GPT-3 -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2020</span><div class="mc-info"><h3>GPT-3</h3><p>175 billion parameters — "Language Models are Few-Shot Learners." GPT-3 demonstrated that massive scale enables in-context learning: give it a few examples in the prompt, and it generalizes without any gradient updates.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">175B params, 300B tokens, 96 layers, 96 heads -- few-shot via prompt alone</div>
<div class="mc-demo" id="demo-gpt3"></div></div>

<!-- ViT -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2020</span><div class="mc-info"><h3>ViT (Vision Transformer)</h3><p>Dosovitskiy et al. — split an image into 16x16 patches, flatten each into a vector, add positional embeddings, and feed them into a standard Transformer encoder. Proved that pure attention (no convolutions!) works for vision at scale.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Image -> 16x16 patches -> linear embed + pos -> Transformer Encoder -> [CLS] -> classify</div>
<div class="mc-demo" id="demo-vit"></div></div>

<!-- CLIP -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2021</span><div class="mc-info"><h3>CLIP</h3><p>Radford et al.'s contrastive learning — train an image encoder and text encoder to produce similar embeddings for matching image-text pairs. Enables zero-shot classification: compare image embedding to text descriptions of any category.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">similarity = image_embed . text_embed    contrastive loss on (image, text) pairs</div>
<div class="mc-demo" id="demo-clip"></div></div>

<!-- DIFFUSION -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2020-22</span><div class="mc-info"><h3>Diffusion Models</h3><p>Ho et al.'s denoising diffusion — forward process adds Gaussian noise step by step until pure noise; the model learns to reverse this, denoising step by step to generate images. Powers DALL-E 2, Stable Diffusion, and Midjourney.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Forward: x_t = sqrt(alpha_t) x_0 + sqrt(1-alpha_t) epsilon    Reverse: x_{t-1} = denoise(x_t)</div>
<div class="mc-demo" id="demo-diff"></div></div>

<!-- CHATGPT -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2022</span><div class="mc-info"><h3>ChatGPT (RLHF)</h3><p>OpenAI's ChatGPT — fine-tune GPT with Reinforcement Learning from Human Feedback. Humans rank model outputs, train a reward model on those preferences, then use PPO to optimize the language model toward human-preferred behavior.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">SFT -> Reward Model from human rankings -> PPO optimization -> aligned chatbot</div>
<div class="mc-demo" id="demo-rlhf"></div></div>

<!-- LLAMA -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2023</span><div class="mc-info"><h3>LLaMA</h3><p>Meta's open-weight LLM — showed that smaller models trained on more tokens can match or beat larger models trained on less data. LLaMA-13B outperformed GPT-3 175B. Catalyzed the open-source AI movement.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Chinchilla scaling: train longer on more data, not just bigger models -> efficiency</div>
<div class="mc-demo" id="demo-llama"></div></div>

<!-- GPT-4 -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2023</span><div class="mc-info"><h3>GPT-4</h3><p>OpenAI's multimodal frontier model — accepts both text and images as input. Demonstrated remarkable reasoning, passing bar exams and medical tests. Represents the emergence of truly general-purpose AI capabilities.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Multimodal: [text + image] -> unified representation -> text output    "see and reason"</div>
<div class="mc-demo" id="demo-gpt4"></div></div>

<!-- CLAUDE -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2023-24</span><div class="mc-info"><h3>Claude</h3><p>Anthropic's Constitutional AI approach — instead of relying solely on human labelers, Claude uses a set of principles (a "constitution") to self-critique and revise its outputs. This scales alignment by having the AI help align itself.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Generate -> Critique (via principles) -> Revise -> RLAIF    "AI helping align AI"</div>
<div class="mc-demo" id="demo-claude"></div></div>

<!-- SORA -->
<div class="model-card"><div class="mc-head"><span class="mc-year" style="color:var(--a8)">2024</span><div class="mc-info"><h3>Sora</h3><p>OpenAI's video generation model — extends diffusion to the temporal dimension. Processes spacetime patches to generate coherent videos from text descriptions. Demonstrates understanding of 3D consistency, physics, and long-range temporal coherence.</p></div></div>
<div class="mc-formula" style="color:var(--a8)">Text -> spacetime patches -> diffusion denoising in latent space -> video frames</div>
<div class="mc-demo" id="demo-sora"></div></div>

</div>
<footer><a href="section7.html">&larr; Section VII</a> &middot; <a href="index.html">Back to Home &middot; 69 Models Complete! \ud83c\udf89</a></footer>
<script src="shared.js"></script>
<script>
// ============ GPT-3: Few-shot prompting demo ============
(function(){
const el=$('demo-gpt3'),[c,ctx]=createCanvas(el,750,260);
addHint(el,'Switch between zero-shot, one-shot, and few-shot to see how examples in the prompt improve accuracy');
const modes=[
{name:'Zero-shot',shots:0,examples:[],query:'Translate "hello" to French:',answer:'bonjour',conf:62},
{name:'One-shot',shots:1,examples:['good morning -> bonjour le matin'],query:'Translate "hello" to French:',answer:'bonjour',conf:84},
{name:'Few-shot',shots:3,examples:['good morning -> bonjour le matin','thank you -> merci','goodbye -> au revoir'],query:'Translate "hello" to French:',answer:'bonjour',conf:97},
];let sel=2;
function draw(){ctx.clearRect(0,0,750,260);let m=modes[sel];
ctx.fillStyle='#34d399';ctx.font='700 14px Fira Code';ctx.textAlign='center';ctx.fillText(`${m.name} (${m.shots} example${m.shots!==1?'s':''})`,375,22);
// Prompt box
let px=30,py=38,pw=430,ph=160;
ctx.fillStyle='rgba(52,211,153,.04)';ctx.beginPath();ctx.roundRect(px,py,pw,ph,10);ctx.fill();
ctx.strokeStyle='#34d39933';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(px,py,pw,ph,10);ctx.stroke();
ctx.fillStyle='#34d399';ctx.font='600 9px Fira Code';ctx.textAlign='left';ctx.fillText('PROMPT',px+10,py+16);
let ty=py+32;
m.examples.forEach((ex,i)=>{ctx.fillStyle='#ffd166';ctx.font='400 10px Fira Code';ctx.fillText(ex,px+10,ty);ty+=18});
if(m.examples.length)ty+=5;
ctx.fillStyle='#e4e2df';ctx.font='500 11px Fira Code';ctx.fillText(m.query,px+10,ty);
// Output
let ox=480,oy=py;
ctx.fillStyle='rgba(52,211,153,.04)';ctx.beginPath();ctx.roundRect(ox,oy,240,ph,10);ctx.fill();
ctx.strokeStyle='#34d39933';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(ox,oy,240,ph,10);ctx.stroke();
ctx.fillStyle='#34d399';ctx.font='600 9px Fira Code';ctx.fillText('OUTPUT',ox+10,oy+16);
ctx.fillStyle='#fff';ctx.font='700 18px Fraunces';ctx.fillText(`"${m.answer}"`,ox+10,oy+50);
// Confidence
ctx.fillStyle='#111120';ctx.fillRect(ox+10,oy+65,200,18);
ctx.fillStyle=m.conf>90?'#34d39988':m.conf>75?'#ffd16688':'#ff6b6b88';
ctx.fillRect(ox+10,oy+65,200*(m.conf/100),18);
ctx.fillStyle='#e4e2df';ctx.font='600 10px Fira Code';ctx.fillText(`${m.conf}% confidence`,ox+15,oy+79);
// Insight
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';
ctx.fillText('More examples in prompt = better output',ox+10,oy+105);
ctx.fillText('No gradient updates needed!',ox+10,oy+122);
ctx.fillText(`Model: 175B parameters`,ox+10,oy+145);
// Scale comparison
ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(30,210,690,40,8);ctx.fill();
ctx.fillStyle='#34d399';ctx.font='500 9px Fira Code';let sizes=[{n:'GPT-1',p:'117M',w:15},{n:'GPT-2',p:'1.5B',w:30},{n:'GPT-3',p:'175B',w:200}];
let sx=50;sizes.forEach(s=>{ctx.fillStyle='rgba(52,211,153,.15)';ctx.fillRect(sx,218,s.w,20);ctx.strokeStyle='#34d39944';ctx.strokeRect(sx,218,s.w,20);
ctx.fillStyle='#e4e2df';ctx.font='500 8px Fira Code';ctx.fillText(`${s.n} ${s.p}`,sx+3,232);sx+=s.w+8});
ctx.fillStyle='#ffd166';ctx.font='400 9px Fira Code';ctx.fillText('\u26a1 117x bigger than GPT-2 = emergent few-shot abilities',sx+10,232)}
const ctrl=addControls(el);modes.forEach((m,i)=>{let b=document.createElement('button');b.className='btn'+(i===2?' active':'');b.textContent=m.name;
b.onclick=()=>{sel=i;ctrl.querySelectorAll('.btn').forEach(x=>x.classList.remove('active'));b.classList.add('active');draw()};ctrl.appendChild(b)});draw()})();

// ============ ViT: Image to patches animation ============
(function(){
const el=$('demo-vit'),[c,ctx]=createCanvas(el,750,280);
addHint(el,'Click "Split Patches" to see an image divided into tokens -- watch them flow through the Transformer');
let phase='image',patchSize=4,grid=8,t=0;let patches=[];
for(let r=0;r<grid;r++)for(let cc=0;cc<grid;cc++)patches.push({r,c:cc,hue:rand(120,280),sat:rand(30,70),bri:rand(25,55),
targetX:0,targetY:0,curX:30+cc*24,curY:30+r*24});
function split(){phase='patches';let ox=30;patches.forEach((p,i)=>{p.targetX=ox+i*10.2;p.targetY=220})}
function toTransformer(){phase='transformer';patches.forEach((p,i)=>{p.targetX=280+i*5.5;p.targetY=140})}
function draw(){t+=.02;ctx.clearRect(0,0,750,280);
// Animate patches
patches.forEach(p=>{p.curX=lerp(p.curX,phase==='image'?30+p.c*24:p.targetX,.06);
p.curY=lerp(p.curY,phase==='image'?30+p.r*24:p.targetY,.06)});
if(phase==='image'){ctx.fillStyle='#ffd166';ctx.font='600 10px Fira Code';ctx.fillText('Original Image (8x8 grid)',30,22);
patches.forEach(p=>{ctx.fillStyle=`hsl(${p.hue},${p.sat}%,${p.bri}%)`;ctx.fillRect(p.curX,p.curY,22,22)})}
else{patches.forEach((p,i)=>{let s=phase==='patches'?8:4;
ctx.fillStyle=`hsl(${p.hue},${p.sat}%,${p.bri}%)`;ctx.fillRect(p.curX,p.curY,s,s)})}
if(phase==='patches'){ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.fillText('64 patches \u2192 64 tokens (each flattened to a vector)',30,215);
ctx.fillStyle='#ffd166';ctx.font='400 9px Fira Code';ctx.fillText('+ positional embeddings added to preserve spatial info',30,260)}
if(phase==='transformer'){
ctx.fillStyle='#4ecdc4';ctx.font='600 10px Fira Code';ctx.fillText('Transformer Encoder',280,125);
ctx.strokeStyle='#4ecdc433';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(275,130,360,30,6);ctx.stroke();
// CLS token
ctx.save();ctx.shadowColor='#ffd166';ctx.shadowBlur=10;
ctx.fillStyle='#ffd166';ctx.beginPath();ctx.arc(270,145,8,0,TAU);ctx.fill();ctx.restore();
ctx.fillStyle='#000';ctx.font='bold 8px Fira Code';ctx.textAlign='center';ctx.fillText('CLS',270,148);
// Output
ctx.fillStyle='#34d399';ctx.font='600 10px Fira Code';ctx.textAlign='left';ctx.fillText('\u2192 Classification head',650,148);
// Self-attention lines
for(let i=0;i<10;i++){let x1=280+i*5.5,x2=280+randInt(0,64)*5.5;
ctx.strokeStyle='rgba(78,205,196,.1)';ctx.lineWidth=.5;
ctx.beginPath();ctx.moveTo(x1,140);ctx.quadraticCurveTo((x1+x2)/2,115+Math.sin(t+i)*10,x2,140);ctx.stroke()}}
// Architecture diagram (right side)
if(phase==='image'){let rx=280;
ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(rx,25,440,220,10);ctx.fill();ctx.strokeStyle='#1e1e32';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(rx,25,440,220,10);ctx.stroke();
ctx.fillStyle='#ffd166';ctx.font='600 11px Fira Code';ctx.fillText('Vision Transformer Pipeline',rx+15,48);
let steps=['1. Split image into 16x16 patches','2. Flatten each patch to a vector','3. Linear projection to embedding dim','4. Add [CLS] token + positional embeddings','5. Feed all tokens into Transformer Encoder','6. Self-attention across ALL patches','7. [CLS] token output -> classification'];
ctx.fillStyle='#7d7a8c';ctx.font='400 10px DM Sans';
steps.forEach((s,i)=>ctx.fillText(s,rx+15,70+i*22));
ctx.fillStyle='#34d399';ctx.font='500 9px Fira Code';ctx.fillText('No convolutions at all -- pure attention!',rx+15,230)}
requestAnimationFrame(draw)}
const ctrl=addControls(el);
const sb=document.createElement('button');sb.className='btn';sb.textContent='\u2702 Split Patches';sb.onclick=split;
const tb=document.createElement('button');tb.className='btn';tb.textContent='\u26a1 Transformer';tb.onclick=toTransformer;
const rst=document.createElement('button');rst.className='btn';rst.textContent='\u21ba';rst.onclick=()=>{phase='image';patches.forEach(p=>{p.targetX=30+p.c*24;p.targetY=30+p.r*24})};
ctrl.appendChild(sb);ctrl.appendChild(tb);ctrl.appendChild(rst);draw()})();

// ============ CLIP: Dual-encoder matching ============
(function(){
const el=$('demo-clip'),[c,ctx]=createCanvas(el,750,250);
addHint(el,'Click an image and a text to see their similarity score -- CLIP matches images to text descriptions');
const images=[{name:'\ud83d\udc31 Cat',embed:[.9,.1,.2,.05]},{name:'\ud83d\udc36 Dog',embed:[.8,.2,.15,.1]},{name:'\ud83c\udf0a Ocean',embed:[.1,.05,.9,.8]},{name:'\ud83c\udf05 Sunset',embed:[.15,.1,.7,.9]}];
const texts=[{name:'a furry pet',embed:[.85,.15,.1,.05]},{name:'waves crashing',embed:[.1,.05,.95,.7]},{name:'golden hour sky',embed:[.1,.08,.6,.95]},{name:'cute animal',embed:[.88,.18,.12,.08]}];
let selImg=0,selTxt=0;
function cosine(a,b){let d=0,na=0,nb=0;a.forEach((v,i)=>{d+=v*b[i];na+=v*v;nb+=b[i]*b[i]});return d/(Math.sqrt(na)*Math.sqrt(nb))}
function draw(){ctx.clearRect(0,0,750,250);
// Image encoder
ctx.fillStyle='#38bdf8';ctx.font='600 10px Fira Code';ctx.fillText('Image Encoder',50,20);
images.forEach((img,i)=>{let y=32+i*42,active=i===selImg;
ctx.save();if(active){ctx.shadowColor='#38bdf8';ctx.shadowBlur=10}
ctx.beginPath();ctx.roundRect(20,y,140,35,8);ctx.fillStyle=active?'rgba(56,189,248,.15)':'rgba(56,189,248,.04)';ctx.fill();
ctx.strokeStyle=active?'#38bdf8':'#38bdf833';ctx.lineWidth=active?2:1;ctx.stroke();ctx.restore();
ctx.fillStyle=active?'#fff':'#7d7a8c';ctx.font='500 14px sans-serif';ctx.fillText(img.name,30,y+23)});
// Text encoder
ctx.fillStyle='#4ecdc4';ctx.font='600 10px Fira Code';ctx.fillText('Text Encoder',580,20);
texts.forEach((txt,i)=>{let y=32+i*42,active=i===selTxt;
ctx.save();if(active){ctx.shadowColor='#4ecdc4';ctx.shadowBlur=10}
ctx.beginPath();ctx.roundRect(560,y,170,35,8);ctx.fillStyle=active?'rgba(78,205,196,.15)':'rgba(78,205,196,.04)';ctx.fill();
ctx.strokeStyle=active?'#4ecdc4':'#4ecdc433';ctx.lineWidth=active?2:1;ctx.stroke();ctx.restore();
ctx.fillStyle=active?'#fff':'#7d7a8c';ctx.font='500 11px Fira Code';ctx.fillText(txt.name,572,y+23)});
// Similarity matrix
let mx=200,my=25,cs=40;
ctx.fillStyle='#ffd166';ctx.font='600 9px Fira Code';ctx.textAlign='center';ctx.fillText('Similarity Matrix',mx+cs*2,18);
images.forEach((img,i)=>{texts.forEach((txt,j)=>{let x=mx+j*cs,y=my+i*cs;
let sim=cosine(img.embed,txt.embed);let active=i===selImg&&j===selTxt;
ctx.fillStyle=`rgba(255,209,102,${sim})`;ctx.fillRect(x+1,y+1,cs-2,cs-2);
if(active){ctx.strokeStyle='#fff';ctx.lineWidth=2;ctx.strokeRect(x,y,cs,cs)}
ctx.fillStyle=sim>.5?'#000':'#ffd16688';ctx.font='500 9px Fira Code';ctx.fillText((sim*100|0),x+cs/2,y+cs/2+3)})});
// Active pair info
let sim=cosine(images[selImg].embed,texts[selTxt].embed);
ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(180,my+4*cs+10,400,45,8);ctx.fill();
ctx.fillStyle=sim>.7?'#34d399':sim>.4?'#ffd166':'#ff6b6b';ctx.font='700 14px Fira Code';
ctx.fillText(`${images[selImg].name}  \u2194  "${texts[selTxt].name}"  =  ${(sim*100).toFixed(0)}%`,375,my+4*cs+38);
ctx.textAlign='left'}
c.onclick=e=>{let r=c.getBoundingClientRect(),mx2=(e.clientX-r.left)*750/r.width,my2=(e.clientY-r.top)*250/r.height;
images.forEach((img,i)=>{if(mx2>=20&&mx2<=160&&my2>=32+i*42&&my2<=67+i*42)selImg=i});
texts.forEach((txt,i)=>{if(mx2>=560&&mx2<=730&&my2>=32+i*42&&my2<=67+i*42)selTxt=i});draw()};draw()})();

// ============ DIFFUSION: Step-by-step denoising ============
(function(){
const el=$('demo-diff'),[c,ctx]=createCanvas(el,750,260);
addHint(el,'Click "Denoise Step" to progressively remove noise -- watch the signal emerge from pure randomness');
const N=20,steps=10;let curStep=steps;
let signal=Array(N).fill(0).map((_,i)=>Math.sin(i*.35)*.7+Math.cos(i*.15)*.3);
let noisy=signal.map(()=>rand(-1,1));
function denoise(){if(curStep<=0)return;curStep--;
let alpha=curStep/steps;noisy=noisy.map((v,i)=>v*(alpha)+signal[i]*(1-alpha)+rand(-.02,.02)*(alpha));draw()}
function draw(){ctx.clearRect(0,0,750,260);
let ox=30,ow=690,oh=100,oy=50;
ctx.fillStyle='#4a475a';ctx.font='600 10px Fira Code';ctx.fillText(`Step ${steps-curStep}/${steps}  (t=${curStep})`,ox,20);
let pct=((steps-curStep)/steps*100).toFixed(0);ctx.fillStyle=curStep===0?'#34d399':'#ffd166';ctx.fillText(`${pct}% denoised`,200,20);
// Progress bar
ctx.fillStyle='#111120';ctx.fillRect(ox,30,ow,6);
ctx.fillStyle='linear-gradient(90deg,#a78bfa,#4ecdc4)';
let grad=ctx.createLinearGradient(ox,0,ox+ow,0);grad.addColorStop(0,'#a78bfa');grad.addColorStop(1,'#4ecdc4');
ctx.fillStyle=grad;ctx.fillRect(ox,30,ow*((steps-curStep)/steps),6);
// Noisy signal
ctx.strokeStyle='#e4e2df';ctx.lineWidth=2.5;ctx.beginPath();
noisy.forEach((v,i)=>{let x=ox+i*(ow/(N-1)),y=oy+oh/2-v*oh/2;i?ctx.lineTo(x,y):ctx.moveTo(x,y)});ctx.stroke();
noisy.forEach((v,i)=>{let x=ox+i*(ow/(N-1)),y=oy+oh/2-v*oh/2;
ctx.beginPath();ctx.arc(x,y,4,0,TAU);
let alpha2=curStep/steps;ctx.fillStyle=`rgba(${167+88*(1-alpha2)|0},${139+66*(1-alpha2)|0},${250*(alpha2)+196*(1-alpha2)|0},1)`;ctx.fill()});
// Original (faint reference)
ctx.strokeStyle='#4ecdc433';ctx.lineWidth=1;ctx.setLineDash([4,4]);ctx.beginPath();
signal.forEach((v,i)=>{let x=ox+i*(ow/(N-1)),y=oy+oh/2-v*oh/2;i?ctx.lineTo(x,y):ctx.moveTo(x,y)});ctx.stroke();ctx.setLineDash([]);
// Timeline at bottom
let ty=175;ctx.fillStyle='#7d7a8c';ctx.font='500 9px Fira Code';ctx.fillText('Forward Process (add noise):',ox,ty);
for(let i=0;i<=steps;i++){let x=ox+i*(ow/steps),active=i===(steps-curStep);
ctx.fillStyle=active?'#fff':'#4a475a';ctx.beginPath();ctx.arc(x,ty+18,active?6:4,0,TAU);ctx.fill();
if(i===0){ctx.fillStyle='#4ecdc4';ctx.font='400 7px Fira Code';ctx.textAlign='center';ctx.fillText('clean',x,ty+35)}
if(i===steps){ctx.fillStyle='#a78bfa';ctx.fillText('noise',x,ty+35)}}
ctx.textAlign='left';ctx.fillStyle='#ffd166';ctx.font='500 9px Fira Code';ctx.fillText('Reverse Process (denoise):',ox,ty+50);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';ctx.fillText('Model learns to predict and remove noise at each step \u2192 generates from scratch',ox,ty+68)}
const ctrl=addControls(el);const btn=document.createElement('button');btn.className='btn';btn.textContent='\u25b6 Denoise Step';btn.onclick=denoise;
let timer=null;const abtn=document.createElement('button');abtn.className='btn';abtn.textContent='\u23e9 Full Denoise';
abtn.onclick=()=>{if(timer)return;timer=setInterval(()=>{denoise();if(curStep<=0){clearInterval(timer);timer=null}},200)};
const rst=document.createElement('button');rst.className='btn';rst.textContent='\u21ba Noise';rst.onclick=()=>{curStep=steps;noisy=signal.map(()=>rand(-1,1));if(timer){clearInterval(timer);timer=null}draw()};
ctrl.appendChild(btn);ctrl.appendChild(abtn);ctrl.appendChild(rst);draw()})();

// ============ CHATGPT / RLHF: Training pipeline ============
(function(){
const el=$('demo-rlhf'),[c,ctx]=createCanvas(el,750,250);
addHint(el,'Click through the 3 RLHF stages to see how human preferences shape the model\'s behavior');
let stage=0;const stages=[
{title:'Stage 1: Supervised Fine-Tuning (SFT)',desc:'Train on high-quality human demonstrations',color:'#38bdf8',
detail:'Human labelers write ideal responses to prompts. The model learns from these examples via standard fine-tuning.'},
{title:'Stage 2: Reward Model Training',desc:'Humans rank multiple outputs to train a reward scorer',color:'#ffd166',
detail:'For each prompt, generate 4-9 outputs. Humans rank them best-to-worst. Train a model to predict human preferences.'},
{title:'Stage 3: PPO Optimization',desc:'Use reward model to optimize the language model via RL',color:'#34d399',
detail:'Generate responses, score them with the reward model, update the LM with PPO to maximize reward while staying close to SFT policy.'}
];
function draw(){ctx.clearRect(0,0,750,250);let s=stages[stage];
// Stage indicators
let sx=100;stages.forEach((st,i)=>{let x=sx+i*200,active=i===stage,done=i<stage;
ctx.save();if(active){ctx.shadowColor=st.color;ctx.shadowBlur=12}
ctx.beginPath();ctx.arc(x,30,18,0,TAU);ctx.fillStyle=active?st.color+'33':done?st.color+'22':'#111120';ctx.fill();
ctx.strokeStyle=active?st.color:done?st.color+'66':'#1e1e32';ctx.lineWidth=active?2.5:1.5;ctx.stroke();ctx.restore();
ctx.fillStyle=active?'#fff':done?st.color:'#4a475a';ctx.font='bold 14px Fira Code';ctx.textAlign='center';ctx.fillText(i+1+'',x,35);
if(i<2){ctx.strokeStyle=done?stages[i+1].color+'44':'#1e1e32';ctx.lineWidth=1.5;ctx.beginPath();ctx.moveTo(x+22,30);ctx.lineTo(x+178,30);ctx.stroke()}});
// Content
ctx.fillStyle=s.color;ctx.font='700 14px Fira Code';ctx.textAlign='center';ctx.fillText(s.title,375,75);
ctx.fillStyle='#e4e2df';ctx.font='400 11px DM Sans';ctx.fillText(s.desc,375,95);
// Visual for each stage
let vy=115;
if(stage===0){
ctx.fillStyle='rgba(56,189,248,.06)';ctx.beginPath();ctx.roundRect(100,vy,250,100,10);ctx.fill();ctx.strokeStyle='#38bdf833';ctx.beginPath();ctx.roundRect(100,vy,250,100,10);ctx.stroke();
ctx.fillStyle='#38bdf8';ctx.font='500 10px Fira Code';ctx.textAlign='left';ctx.fillText('\ud83d\udc64 Human writes ideal response',112,vy+20);
ctx.fillStyle='#7d7a8c';ctx.fillText('Prompt: "Explain gravity"',112,vy+42);ctx.fillStyle='#e4e2df';ctx.fillText('Response: "Gravity is a force..."',112,vy+60);
ctx.fillStyle='#38bdf8';ctx.font='28px sans-serif';ctx.textAlign='center';ctx.fillText('\u2192',380,vy+50);
ctx.fillStyle='rgba(56,189,248,.06)';ctx.beginPath();ctx.roundRect(410,vy,250,100,10);ctx.fill();ctx.strokeStyle='#38bdf833';ctx.beginPath();ctx.roundRect(410,vy,250,100,10);ctx.stroke();
ctx.fillStyle='#38bdf8';ctx.font='500 10px Fira Code';ctx.textAlign='left';ctx.fillText('\ud83e\udd16 Model fine-tuned on demos',422,vy+20);
ctx.fillStyle='#7d7a8c';ctx.fillText('Standard cross-entropy loss',422,vy+42);ctx.fillText('~13K demonstration examples',422,vy+60)}
if(stage===1){let responses=['Great explanation!','Too verbose','Has errors','Confusing'];
responses.forEach((r,i)=>{let y=vy+i*24;
ctx.fillStyle=i===0?'rgba(255,209,102,.12)':'rgba(255,209,102,.04)';ctx.beginPath();ctx.roundRect(50,y,400,20,4);ctx.fill();
ctx.fillStyle=i===0?'#ffd166':'#7d7a8c';ctx.font='500 10px Fira Code';ctx.textAlign='left';
ctx.fillText(`${4-i}. ${r}`,60,y+14);ctx.fillStyle='#ffd166';ctx.textAlign='right';ctx.fillText(['\u2b50\u2b50\u2b50\u2b50','\u2b50\u2b50\u2b50','\u2b50\u2b50','\u2b50'][i],440,y+14)});
ctx.fillStyle='#ffd166';ctx.font='28px sans-serif';ctx.textAlign='center';ctx.fillText('\u2192',500,vy+45);
ctx.textAlign='left';ctx.fillStyle='#ffd166';ctx.font='600 11px Fira Code';ctx.fillText('Reward Model',540,vy+20);
ctx.fillStyle='#7d7a8c';ctx.font='400 10px Fira Code';ctx.fillText('Learns to score outputs',540,vy+40);ctx.fillText('by human preference',540,vy+56)}
if(stage===2){ctx.textAlign='left';
[{n:'Generate',x:60,e:'\ud83e\udd16'},{n:'Score',x:220,e:'\ud83c\udfc6'},{n:'Update',x:380,e:'\u2699\ufe0f'},{n:'Repeat',x:540,e:'\ud83d\udd04'}].forEach((s2,i)=>{
ctx.fillStyle='rgba(52,211,153,.06)';ctx.beginPath();ctx.roundRect(s2.x,vy,130,75,10);ctx.fill();ctx.strokeStyle='#34d39933';ctx.beginPath();ctx.roundRect(s2.x,vy,130,75,10);ctx.stroke();
ctx.fillStyle='#34d399';ctx.font='24px sans-serif';ctx.textAlign='center';ctx.fillText(s2.e,s2.x+65,vy+30);
ctx.font='500 9px Fira Code';ctx.fillText(s2.n,s2.x+65,vy+50);
if(i<3){ctx.fillStyle='#34d399';ctx.font='16px sans-serif';ctx.fillText('\u2192',s2.x+140,vy+35)}})}
ctx.textAlign='left';ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(30,225,690,20,4);ctx.fill();
ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';ctx.fillText(s.detail,40,239)}
const ctrl=addControls(el);stages.forEach((s,i)=>{let b=document.createElement('button');b.className='btn'+(i===0?' active':'');b.textContent=`Stage ${i+1}`;b.style=`color:${s.color};border-color:${s.color}33`;
b.onclick=()=>{stage=i;ctrl.querySelectorAll('.btn').forEach(x=>x.classList.remove('active'));b.classList.add('active');draw()};ctrl.appendChild(b)});draw()})();

// ============ LLAMA: Efficiency / Chinchilla scaling ============
(function(){
const el=$('demo-llama'),[c,ctx]=createCanvas(el,750,220);
addHint(el,'Hover over models to compare -- LLaMA-13B beats GPT-3 175B by training on more tokens');
const models=[
{n:'GPT-3',p:175,tok:300,perf:72,x:160,c:'#7d7a8c'},{n:'Chinchilla',p:70,tok:1400,perf:74,x:340,c:'#ffd166'},
{n:'LLaMA-7B',p:7,tok:1000,perf:70,x:440,c:'#34d399'},{n:'LLaMA-13B',p:13,tok:1000,perf:73.5,x:520,c:'#34d399'},
{n:'LLaMA-65B',p:65,tok:1400,perf:77,x:630,c:'#34d399'}];
let hovered=-1;
function draw(){ctx.clearRect(0,0,750,220);
let gy=35,gh=110,gx=80,gw=620;
ctx.strokeStyle='#151520';for(let i=0;i<=4;i++){let y=gy+i*gh/4;ctx.beginPath();ctx.moveTo(gx,y);ctx.lineTo(gx+gw,y);ctx.stroke();
ctx.fillStyle='#4a475a';ctx.font='400 8px Fira Code';ctx.textAlign='right';ctx.fillText((80-i*5)+'',gx-5,y+3)}
ctx.textAlign='left';ctx.fillStyle='#4a475a';ctx.font='400 8px Fira Code';ctx.fillText('Benchmark Score',gx-5,gy-10);
models.forEach((m,i)=>{let barH=(m.perf-60)/25*gh,y=gy+gh-barH,active=i===hovered;
let bw=active?55:40;
ctx.save();if(active){ctx.shadowColor=m.c;ctx.shadowBlur=12}
ctx.fillStyle=m.c+(active?'66':'33');ctx.beginPath();ctx.roundRect(m.x-bw/2,y,bw,barH,4);ctx.fill();
ctx.strokeStyle=m.c;ctx.lineWidth=active?2:1;ctx.beginPath();ctx.roundRect(m.x-bw/2,y,bw,barH,4);ctx.stroke();ctx.restore();
ctx.fillStyle=m.c;ctx.font=`${active?'600':'400'} ${active?'10':'8'}px Fira Code`;ctx.textAlign='center';
ctx.fillText(m.n,m.x,gy+gh+14);ctx.fillStyle='#7d7a8c';ctx.font='400 7px Fira Code';
ctx.fillText(`${m.p}B / ${m.tok}B tok`,m.x,gy+gh+26);
if(active){ctx.fillStyle=m.c;ctx.font='600 11px Fira Code';ctx.fillText(`${m.perf}`,m.x,y-8)}});
ctx.textAlign='left';ctx.fillStyle='rgba(6,6,12,.85)';ctx.beginPath();ctx.roundRect(30,180,690,30,6);ctx.fill();
ctx.fillStyle='#34d399';ctx.font='500 9px Fira Code';
ctx.fillText('\ud83d\udca1 LLaMA-13B (13B params, 1T tokens) \u2248 GPT-3 (175B params, 300B tokens) -- train longer, not bigger!',40,199)}
c.onmousemove=e=>{let r=c.getBoundingClientRect(),mx=(e.clientX-r.left)*750/r.width;
hovered=-1;models.forEach((m,i)=>{if(Math.abs(mx-m.x)<35)hovered=i});draw()};
c.onmouseleave=()=>{hovered=-1;draw()};draw()})();

// ============ GPT-4: Multimodal input ============
(function(){
const el=$('demo-gpt4'),[c,ctx]=createCanvas(el,750,220);
addHint(el,'Toggle between text-only and multimodal modes to see how GPT-4 handles images + text together');
let mode='multi';
function draw(){ctx.clearRect(0,0,750,220);
// Input side
let ix=20,iy=25;
ctx.fillStyle='rgba(167,139,250,.04)';ctx.beginPath();ctx.roundRect(ix,iy,310,160,10);ctx.fill();ctx.strokeStyle='#a78bfa33';ctx.beginPath();ctx.roundRect(ix,iy,310,160,10);ctx.stroke();
ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.fillText('INPUT',ix+10,iy+18);
if(mode==='multi'){
ctx.fillStyle='rgba(255,209,102,.08)';ctx.beginPath();ctx.roundRect(ix+10,iy+28,130,90,8);ctx.fill();ctx.strokeStyle='#ffd16633';ctx.beginPath();ctx.roundRect(ix+10,iy+28,130,90,8);ctx.stroke();
ctx.fillStyle='#ffd166';ctx.font='40px sans-serif';ctx.textAlign='center';ctx.fillText('\ud83d\uddbc\ufe0f',ix+75,iy+75);
ctx.font='400 8px Fira Code';ctx.fillText('image input',ix+75,iy+105);
ctx.textAlign='left';ctx.fillStyle='#e4e2df';ctx.font='400 10px DM Sans';ctx.fillText('"What\'s happening',ix+155,iy+55);ctx.fillText('in this image?"',ix+155,iy+72)}
else{ctx.fillStyle='#e4e2df';ctx.font='400 10px DM Sans';ctx.fillText('"Explain how quantum',ix+15,iy+55);ctx.fillText('entanglement works',ix+15,iy+72);ctx.fillText('in simple terms."',ix+15,iy+89)}
// Architecture
let ax=345;ctx.fillStyle='#a78bfa';ctx.font='28px sans-serif';ctx.textAlign='center';ctx.fillText('\u2192',ax,100);
ctx.fillStyle='rgba(167,139,250,.06)';ctx.beginPath();ctx.roundRect(ax+20,iy,140,160,10);ctx.fill();ctx.strokeStyle='#a78bfa33';ctx.beginPath();ctx.roundRect(ax+20,iy,140,160,10);ctx.stroke();
ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.textAlign='center';ctx.fillText('GPT-4',ax+90,iy+18);
if(mode==='multi'){ctx.fillStyle='#ffd166';ctx.fillText('\ud83d\udc41\ufe0f Vision',ax+90,iy+50);ctx.fillStyle='#38bdf8';ctx.fillText('\ud83d\udcdd Language',ax+90,iy+75);
ctx.fillStyle='#a78bfa';ctx.fillText('\u2194 Fused',ax+90,iy+100)}
else{ctx.fillStyle='#38bdf8';ctx.fillText('\ud83d\udcdd Language',ax+90,iy+65);ctx.fillStyle='#7d7a8c';ctx.fillText('text only',ax+90,iy+85)}
// Output
ctx.fillStyle='#a78bfa';ctx.font='28px sans-serif';ctx.fillText('\u2192',ax+175,100);
ctx.fillStyle='rgba(78,205,196,.04)';ctx.beginPath();ctx.roundRect(555,iy,175,160,10);ctx.fill();ctx.strokeStyle='#4ecdc433';ctx.beginPath();ctx.roundRect(555,iy,175,160,10);ctx.stroke();
ctx.fillStyle='#4ecdc4';ctx.font='600 10px Fira Code';ctx.textAlign='left';ctx.fillText('OUTPUT',565,iy+18);
ctx.fillStyle='#e4e2df';ctx.font='400 10px DM Sans';
if(mode==='multi'){ctx.fillText('"The image shows a',565,iy+45);ctx.fillText('cat sitting on a',565,iy+62);ctx.fillText('laptop keyboard..."',565,iy+79)}
else{ctx.fillText('"Quantum entangle-',565,iy+45);ctx.fillText('ment is when two',565,iy+62);ctx.fillText('particles become',565,iy+79);ctx.fillText('linked together..."',565,iy+96)}
// Benchmarks
ctx.fillStyle='#ffd166';ctx.font='500 8px Fira Code';ctx.textAlign='center';ctx.fillText('Bar Exam: 90th percentile  |  SAT Math: 700/800  |  USMLE: passing',375,205);ctx.textAlign='left'}
const ctrl=addControls(el);
const tb=document.createElement('button');tb.className='btn';tb.textContent='\ud83d\udcdd Text Only';tb.onclick=()=>{mode='text';tb.classList.add('active');mb.classList.remove('active');draw()};
const mb=document.createElement('button');mb.className='btn active';mb.textContent='\ud83d\udc41\ufe0f Multimodal';mb.onclick=()=>{mode='multi';mb.classList.add('active');tb.classList.remove('active');draw()};
ctrl.appendChild(mb);ctrl.appendChild(tb);draw()})();

// ============ CLAUDE: Constitutional AI pipeline ============
(function(){
const el=$('demo-claude'),[c,ctx]=createCanvas(el,750,260);
addHint(el,'Step through the Constitutional AI process: Generate \u2192 Critique \u2192 Revise \u2192 RLAIF');
let step=0;const steps=[
{title:'1. Initial Response',content:'"Here\'s a controversial statement without nuance..."',color:'#ff6b6b',label:'Raw output may be problematic'},
{title:'2. Self-Critique (Principles)',content:'Principle: "Be helpful, harmless, honest"\nThis response lacks nuance and could mislead.',color:'#ffd166',label:'AI critiques its own output'},
{title:'3. Revision',content:'"Here\'s a balanced, nuanced perspective that considers multiple viewpoints..."',color:'#4ecdc4',label:'AI revises based on critique'},
{title:'4. RLAIF Training',content:'Use AI-generated preferences (not just human labels) to train the reward model at scale.',color:'#a78bfa',label:'Scale alignment with AI feedback'}
];
function draw(){ctx.clearRect(0,0,750,260);
let s=steps[step];
// Stage indicators
steps.forEach((st,i)=>{let x=80+i*170,active=i===step,done=i<step;
ctx.save();if(active){ctx.shadowColor=st.color;ctx.shadowBlur=14}
ctx.beginPath();ctx.arc(x,28,15,0,TAU);ctx.fillStyle=active?st.color+'33':done?st.color+'22':'#111120';ctx.fill();
ctx.strokeStyle=active?st.color:done?st.color+'55':'#1e1e32';ctx.lineWidth=active?2.5:1;ctx.stroke();ctx.restore();
ctx.fillStyle=active?'#fff':done?st.color:'#4a475a';ctx.font='bold 12px Fira Code';ctx.textAlign='center';ctx.fillText(i+1+'',x,33);
if(i<3){ctx.strokeStyle=done?steps[i+1].color+'33':'#1e1e32';ctx.lineWidth=1.5;ctx.beginPath();ctx.moveTo(x+18,28);ctx.lineTo(x+152,28);ctx.stroke()}});
// Content box
let bx=40,by=58,bw=670,bh=130;
ctx.fillStyle=s.color+'0a';ctx.beginPath();ctx.roundRect(bx,by,bw,bh,12);ctx.fill();
ctx.strokeStyle=s.color+'33';ctx.lineWidth=1.5;ctx.beginPath();ctx.roundRect(bx,by,bw,bh,12);ctx.stroke();
ctx.fillStyle=s.color;ctx.font='700 13px Fira Code';ctx.textAlign='left';ctx.fillText(s.title,bx+15,by+24);
ctx.fillStyle='#e4e2df';ctx.font='400 11px DM Sans';
let lines=s.content.split('\n');lines.forEach((l,i)=>ctx.fillText(l,bx+15,by+48+i*18));
ctx.fillStyle=s.color+'88';ctx.font='500 9px Fira Code';ctx.fillText(s.label,bx+15,by+bh-12);
// Constitution panel
ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(40,200,670,50,8);ctx.fill();
ctx.strokeStyle='#1e1e32';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(40,200,670,50,8);ctx.stroke();
ctx.fillStyle='#a78bfa';ctx.font='600 10px Fira Code';ctx.fillText('\ud83d\udcdc Constitution:',55,218);
ctx.fillStyle='#7d7a8c';ctx.font='400 9px DM Sans';
ctx.fillText('Be helpful and harmless  \u00b7  Be honest  \u00b7  Avoid deception  \u00b7  Respect autonomy  \u00b7  Consider consequences',55,236);
ctx.textAlign='left'}
const ctrl=addControls(el);steps.forEach((s,i)=>{let b=document.createElement('button');b.className='btn'+(i===0?' active':'');b.textContent=`Step ${i+1}`;b.style=`color:${s.color};border-color:${s.color}33`;
b.onclick=()=>{step=i;ctrl.querySelectorAll('.btn').forEach(x=>x.classList.remove('active'));b.classList.add('active');draw()};ctrl.appendChild(b)});draw()})();

// ============ SORA: Spacetime patches + video frames ============
(function(){
const el=$('demo-sora'),[c,ctx]=createCanvas(el,750,260);
addHint(el,'Click "Generate Frame" to watch video frames emerge one by one from spacetime diffusion');
let frames=[],maxF=12,genStep=0,t=0;
function genFrame(){if(frames.length>=maxF)return;
let hue=180+frames.length*15,detail=(.3+frames.length*.06);
frames.push({hue,detail,noise:1-frames.length/maxF*.8});draw()}
function draw(){t+=.02;ctx.clearRect(0,0,750,260);
ctx.fillStyle='#34d399';ctx.font='600 10px Fira Code';ctx.fillText('Text prompt: "A serene lake at sunset with mountains in the background"',20,18);
// Frames
let fx=20,fy=35,fw=55,fh=38,gap=4;
frames.forEach((f,i)=>{let x=fx+i*(fw+gap);
// Frame background
let grad=ctx.createLinearGradient(x,fy,x,fy+fh);
grad.addColorStop(0,`hsla(${f.hue+20},50%,${30+f.detail*20}%,1)`);
grad.addColorStop(.6,`hsla(${f.hue},40%,${20+f.detail*15}%,1)`);
grad.addColorStop(1,`hsla(${f.hue-20},30%,${15+f.detail*10}%,1)`);
ctx.fillStyle=grad;ctx.fillRect(x,fy,fw,fh);
// Mountains
if(f.detail>.3){ctx.fillStyle=`hsla(${f.hue-30},20%,${25+f.detail*10}%,${f.detail})`;
ctx.beginPath();ctx.moveTo(x,fy+fh*.6);ctx.lineTo(x+fw*.3,fy+fh*.2);ctx.lineTo(x+fw*.5,fy+fh*.45);ctx.lineTo(x+fw*.7,fy+fh*.15);ctx.lineTo(x+fw,fy+fh*.5);ctx.lineTo(x+fw,fy+fh);ctx.lineTo(x,fy+fh);ctx.closePath();ctx.fill()}
// Noise overlay
for(let n=0;n<(f.noise*20|0);n++){ctx.fillStyle=`rgba(128,128,128,${f.noise*.3})`;
ctx.fillRect(x+rand(0,fw),fy+rand(0,fh),2,2)}
// Frame number
ctx.fillStyle='#fff8';ctx.font='400 6px Fira Code';ctx.textAlign='center';ctx.fillText(`f${i+1}`,x+fw/2,fy+fh+10)});
// Empty frame slots
for(let i=frames.length;i<maxF;i++){let x=fx+i*(fw+gap);
ctx.strokeStyle='#1e1e32';ctx.lineWidth=1;ctx.setLineDash([2,2]);ctx.strokeRect(x,fy,fw,fh);ctx.setLineDash([])}
// Architecture diagram
let ay=100;ctx.fillStyle='rgba(6,6,12,.88)';ctx.beginPath();ctx.roundRect(20,ay,710,145,10);ctx.fill();ctx.strokeStyle='#1e1e32';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(20,ay,710,145,10);ctx.stroke();
let pipeline=[{n:'Text\nEncoder',c:'#ffd166',x:60},{n:'Spacetime\nPatches',c:'#a78bfa',x:195},{n:'Diffusion\nTransformer',c:'#38bdf8',x:350},{n:'Temporal\nCoherence',c:'#4ecdc4',x:505},{n:'Video\nFrames',c:'#34d399',x:640}];
pipeline.forEach((p,i)=>{
ctx.fillStyle=p.c+'15';ctx.beginPath();ctx.roundRect(p.x-45,ay+20,100,65,8);ctx.fill();
ctx.strokeStyle=p.c+'44';ctx.lineWidth=1;ctx.beginPath();ctx.roundRect(p.x-45,ay+20,100,65,8);ctx.stroke();
ctx.fillStyle=p.c;ctx.font='600 9px Fira Code';ctx.textAlign='center';
let lines=p.n.split('\n');lines.forEach((l,li)=>ctx.fillText(l,p.x+5,ay+48+li*14));
if(i<4){ctx.fillStyle=p.c+'66';ctx.font='16px sans-serif';ctx.fillText('\u2192',p.x+70,ay+55)}});
ctx.textAlign='left';ctx.fillStyle='#7d7a8c';ctx.font='400 9px Fira Code';
ctx.fillText('Video as 3D spacetime volume \u2192 split into patches (like ViT but with time) \u2192 diffusion in latent space',35,ay+110);
ctx.fillText(`Generated: ${frames.length}/${maxF} frames`,35,ay+130);
let pct=(frames.length/maxF*100).toFixed(0);ctx.fillStyle='#34d399';ctx.fillText(`${pct}% complete`,250,ay+130)}
const ctrl=addControls(el);const btn=document.createElement('button');btn.className='btn';btn.textContent='\ud83c\udfac Generate Frame';btn.onclick=genFrame;
let timer=null;const abtn=document.createElement('button');abtn.className='btn';abtn.textContent='\u23e9 Full Video';
abtn.onclick=()=>{if(timer)return;timer=setInterval(()=>{genFrame();if(frames.length>=maxF){clearInterval(timer);timer=null}},250)};
const rst=document.createElement('button');rst.className='btn';rst.textContent='\u21ba';rst.onclick=()=>{frames=[];if(timer){clearInterval(timer);timer=null}draw()};
ctrl.appendChild(btn);ctrl.appendChild(abtn);ctrl.appendChild(rst);draw()})();
</script></body></html>
